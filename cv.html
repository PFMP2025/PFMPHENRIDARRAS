<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>CV Automatis√©</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to right, #f1f2f6, #dbe4f3);
      padding: 2rem;
      color: #343a40;
    }

    .formulaire {
      max-width: 800px;
      margin: auto;
      text-align: center;
      margin-bottom: 2rem;
      background: #ffffff;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .formulaire label {
      font-weight: bold;
      display: block;
      margin-top: 1rem;
    }

    .formulaire input, .formulaire select {
      padding: 0.5rem;
      margin-top: 0.5rem;
      font-size: 1rem;
      width: 90%;
      max-width: 400px;
      border-radius: 6px;
      border: 1px solid #ced4da;
    }

    .cv-container {
      max-width: 800px;
      margin: auto;
      background: #ffffff;
      display: flex;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      overflow: hidden;
      page-break-inside: avoid;
    }

    .cv-left {
      background: #004080;
      color: white;
      width: 30%;
      padding: 1.5rem;
      text-align: center;
      height: 297mm;
      min-height: 100%;
      box-sizing: border-box;
    }

    .cv-left img#photoCV {
      display: block;
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 50%;
      margin: 0 auto 1rem auto;
      border: 3px solid white;
      cursor: pointer;
    }

    .cv-left .editable {
      background-color: rgba(255, 255, 255, 0.1);
      color: #ffffff;
    }

    .cv-left .editable:focus {
      background-color: #ffffff;
      color: #000000;
    }

    .cv-right {
      width: 70%;
      padding: 2rem;
      background: #ffffff;
    }

    .editable {
      border: 1px dashed #c0c0c0;
      border-radius: 4px;
      padding: 0.4rem;
      margin-bottom: 0.4rem;
      transition: background 0.2s ease, color 0.2s ease;
    }

    .editable:focus {
      background: #f1f9ff;
      outline: none;
    }

    h1 {
      color: #2c3e50;
      border-bottom: 2px solid #004080;
      padding-bottom: 0.5rem;
      font-size: 1.8rem;
    }

    h2 {
      color: #004080;
      margin-top: 1.5rem;
      border-left: 4px solid #004080;
      padding-left: 0.5rem;
      font-size: 1.2rem;
    }

    ul {
      padding-left: 1.5rem;
    }

    li {
      margin-bottom: 0.5rem;
    }

    p {
      line-height: 1.6;
    }

    .download {
      text-align: center;
      margin-top: 2rem;
    }

    button {
      padding: 0.8rem 2rem;
      background: #004080;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: #002d5f;
    }

    button:active {
      transform: scale(0.98);
    }

    .add-btn {
      font-size: 0.9rem;
      background: #198754;
      margin-top: 0.5rem;
      border-radius: 4px;
      padding: 0.4rem 1rem;
    }

    .badge {
      display: inline-block;
      background: #eaf4ff;
      border-left: 4px solid #004080;
      padding: 6px 10px;
      margin: 5px 0;
      border-radius: 6px;
      font-size: 0.95rem;
      font-weight: 500;
    }

    .bouton-retour {
      position: fixed;
      top: 10px;
      left: 10px;
      padding: 8px 16px;
      font-size: 16px;
      border-radius: 5px;
      background-color: #007BFF;
      color: white;
      border: none;
      cursor: pointer;
      z-index: 1000;
    }

    .skill-bar {
      background: #e0e0e0;
      border-radius: 20px;
      overflow: hidden;
      height: 8px;
      margin: 5px 0;
    }

    .fill {
      background: #3b82f6;
      height: 100%;
    }

    @media (max-width: 768px) {
      .cv-container {
        flex-direction: column;
        border-radius: 8px;
      }

      .cv-left, .cv-right {
        width: 100%;
        padding: 1rem;
        height: auto !important;
      }

      button, .add-btn {
        width: 100%;
        font-size: 1rem;
        margin-top: 0.5rem;
      }
    }

    .force-desktop {
      flex-direction: row !important;
    }

    .force-desktop .cv-left {
      width: 30% !important;
    }

    .force-desktop .cv-right {
      width: 70% !important;
    }

    .force-desktop .editable {
      border: none !important;
      background: none !important;
      color: #000 !important;
    }

    .force-desktop .cv-left .editable {
      color: #fff !important;
    }
	.hide-in-pdf {
  display: inline-block;
}

.force-desktop .hide-in-pdf {
  display: none !important;
}
.skill-value {
  font-weight: bold;
  margin-left: 8px;
}


  </style>
</head>


<body>
  <button class="bouton-retour" onclick="history.back()">‚Üê Retour</button>
  <div class="formulaire">
    <label for="selectMetier">Choisis ton m√©tier :</label>
    <select id="selectMetier" onchange="updateCV()">
  <optgroup label="CIEL">
    <option>Technicien R√©seaux</option>
    <option>Technicien Informatique</option>
    <option>Technicien Support</option>
    <option>Technicien √âlectronique</option>
    <option>D√©veloppeur Web</option>
    <option>Installateur Domotique</option>
    <option>Int√©grateur IoT</option>
    <option>Technicien Cybers√©curit√©</option>
  </optgroup>
  <optgroup label="MELEC">
    <option>√âlectricien du B√¢timent</option>
    <option>Technicien de Maintenance</option>
    <option>√âlectricien Industriel</option>
    <option>Technicien en R√©gulation CVC</option>
  </optgroup>
  <optgroup label="Chaudronnerie">
    <option>Ouvrier Chaudronnier</option>
    <option>Soudeur</option>
    <option>Assembleur M√©tallique</option>
    <option>Monteur en Tuyauterie</option>
    <option>Op√©rateur CN</option>
    <option>Contr√¥leur Qualit√©</option>
  </optgroup>
</select>

  </div>

  <div class="cv-container" id="cvContent">
    <div class="cv-left">
	<img id="photoCV" src="placeholder.jpg" alt="Photo" onclick="uploadPhoto()">
<input type="file" id="uploadInput" accept="image/*" style="display:none;">

      
      <p contenteditable="true" class="editable">Nom Pr√©nom</p>
      <p contenteditable="true" class="editable">T√©l√©phone</p>
      <p contenteditable="true" class="editable">Email</p>
      <p contenteditable="true" class="editable">Adresse</p>
    </div>
    <div class="cv-right">
      <h1 contenteditable="true" class="editable" id="titre">CV - [M√©tier]</h1>
      <p id="nomEntreprise" contenteditable="true" class="editable" style="font-style: italic; margin-top: -1rem;">Entreprise : _______________________</p>
      <h2>Profil</h2>
      <p id="profil" contenteditable="true" class="editable"></p>
      <h2>Comp√©tences Cl√©s</h2>
      <ul id="competences"></ul>
      <button class="add-btn" id="btnAddComp" onclick="addCompetence()">+ Ajouter une comp√©tence</button>
      <h2>Formation</h2>
      <p contenteditable="true" class="editable">Bac Pro CIEL ou MELEC selon sp√©cialit√©</p>
      <h2>Stages / Exp√©riences</h2>
      <ul id="stages"></ul>
      <button class="add-btn" id="btnAddStage" onclick="addStage()">+ Ajouter une exp√©rience</button>
      <h2>Loisirs</h2>
      <ul id="loisirs">
        <li contenteditable="true" class="editable">Exemple : Lecture, sport, informatique</li>
      </ul>
      <button class="add-btn" id="btnAddLoisir" onclick="addLoisir()">+ Ajouter un loisir</button>
    </div>
  </div>

  <div class="download">
    <button onclick="generatePDF()">üóÉÔ∏è T√©l√©charger le CV en PDF</button>
  </div>

 <script>
const baseCV = {
  "Technicien R√©seaux": {
    profil: "Passionn√© par les infrastructures r√©seaux, la configuration et la cybers√©curit√©.",
    competences: ["Adressage IP, VLAN", "Configuration routeurs/switchs", "Utilisation de Packet Tracer", "R√©solution de pannes"]
  },
  "Technicien Informatique": {
    profil: "Polyvalent et √† l‚Äôaise avec la configuration de postes et le support utilisateur.",
    competences: ["Installation Windows/Linux", "Support technique", "Cr√©ation d‚Äôimages syst√®me", "Gestion de parc"]
  },
  "Technicien Support": {
    profil: "R√©actif, orient√© r√©solution rapide des pannes informatiques.",
    competences: ["Assistance bureautique", "Gestion des tickets", "Maintenance mat√©rielle", "Restauration syst√®me"]
  },
  "Technicien √âlectronique": {
    profil: "Curieux, pr√©cis, aime l‚Äô√©lectronique embarqu√©e.",
    competences: ["Lecture de sch√©mas", "Arduino, multim√®tre", "Soudure composants", "Maintenance syst√®mes embarqu√©s"]
  },
  "D√©veloppeur Web": {
    profil: "Cr√©atif dans la conception de sites interactifs.",
    competences: ["HTML/CSS/JS", "Responsive design", "D√©bogage navigateur", "Utilisation d‚Äô√©diteurs web"]
  },
  "Installateur Domotique": {
    profil: "Sp√©cialiste des syst√®mes connect√©s pour le b√¢timent.",
    competences: ["Installation alarmes, volets", "Syst√®mes KNX, Arduino", "Lecture de plans", "Maintenance domotique"]
  },
  "Int√©grateur IoT": {
    profil: "Passionn√© d‚Äôobjets connect√©s et d‚Äôautomatisation.",
    competences: ["Capteurs/actionneurs", "MQTT, HTTP, TCP/IP", "Raspberry Pi / ESP32", "Connexion r√©seau local"]
  },
  "Technicien Cybers√©curit√©": {
    profil: "Motiv√© par la s√©curit√© des syst√®mes num√©riques.",
    competences: ["Pare-feu, antivirus", "S√©curisation des postes", "Surveillance r√©seau", "RGPD & √©thique num√©rique"]
  },
  "√âlectricien du B√¢timent": {
    profil: "√Ä l‚Äôaise avec les installations dans les logements.",
    competences: ["C√¢blage courant fort/faible", "Lecture de plans", "Pose d‚Äô√©quipements domotiques", "Normes de s√©curit√©"]
  },
  "Technicien de Maintenance": {
    profil: "Capable de maintenir et r√©parer des √©quipements techniques.",
    competences: ["Analyse des pannes", "Lecture de plans", "Maintenance pr√©ventive", "Diagnostic technique"]
  },
  "√âlectricien Industriel": {
    profil: "Sp√©cialiste de l‚Äô√©lectricit√© en milieu industriel.",
    competences: ["Raccordement armoires", "Conduits techniques", "Contr√¥le d‚Äôisolement", "Normes industrielles"]
  },
  "Technicien en R√©gulation CVC": {
    profil: "Technicien CVC, sp√©cialiste en r√©gulation de clim/chauffage.",
    competences: ["R√©gulation PID", "D√©pannage r√©gulateurs", "Lecture de sch√©mas", "Param√©trage √©quipements"]
  },
  "Ouvrier Chaudronnier": {
    profil: "Forme des pi√®ces m√©talliques sur mesure.",
    competences: ["Tra√ßage sur t√¥le", "Lecture de plans", "Soudage TIG/MIG", "Utilisation machines-outils"]
  },
  "Soudeur": {
    profil: "Ma√Ætrise les techniques de soudure pour tous types de m√©taux.",
    competences: ["TIG, MIG, √† l‚Äôarc", "Pr√©paration pi√®ces", "Contr√¥le visuel", "S√©curit√© des soudures"]
  },
  "Assembleur M√©tallique": {
    profil: "Assemble les structures m√©talliques en atelier ou chantier.",
    competences: ["Lecture de plan", "Soudure / boulonnage", "Contr√¥le dimensionnel", "Manutention"]
  },
  "Monteur en Tuyauterie": {
    profil: "Assemble des circuits de tuyaux industriels.",
    competences: ["Pr√©paration tuyaux", "Lecture isom√©triques", "Pointage/soudage", "Montage sur site"]
  },
  "Op√©rateur CN": {
    profil: "Ma√Ætrise les machines √† commande num√©rique.",
    competences: ["Programmation CN simple", "Montage d‚Äôoutils", "Contr√¥le dimensionnel", "Maintenance 1er niveau"]
  },
  "Contr√¥leur Qualit√©": {
    profil: "Garantit la conformit√© des pi√®ces produites.",
    competences: ["Contr√¥le visuel", "Mesure dimensionnelle", "Lecture de plans", "Fiches non-conformit√©"]
  }
};

function updateCV() {
  const metier = document.getElementById("selectMetier").value;
  const data = baseCV[metier] || baseCV["Technicien R√©seaux"];

  document.getElementById("titre").textContent = `CV - ${metier}`;
  document.getElementById("profil").textContent = data.profil;

  const compList = document.getElementById("competences");
  compList.innerHTML = "";
  data.competences.forEach(c => {
  const li = document.createElement("li");

  // Cr√©e le nom de la comp√©tence
  const nom = document.createElement("div");
  nom.contentEditable = true;
  nom.className = "editable";
  nom.textContent = c;

  // Cr√©e la barre de progression
  const bar = document.createElement("div");
  bar.className = "skill-bar";

  const fill = document.createElement("div");
  fill.className = "fill";
  fill.style.width = "70%"; // valeur de base modifiable

  bar.appendChild(fill);

  
const percentage = document.createElement("span");
percentage.textContent = "70%";
percentage.style.marginLeft = "10px";
percentage.className = "skill-value";


const slider = document.createElement("input");
slider.type = "range";
slider.min = 0;
slider.max = 100;
slider.value = 70;
slider.classList.add("hide-in-pdf");
slider.oninput = function () {
  fill.style.width = this.value + "%";
  percentage.textContent = this.value + "%";
};


  // Assemble
  li.appendChild(nom);
  li.appendChild(bar);
  slider.classList.add("hide-in-pdf");
li.appendChild(slider);
li.appendChild(percentage);


  compList.appendChild(li);
});



  const stageList = document.getElementById("stages");
  stageList.innerHTML = "";
  [
    `Stage de 6 semaines dans le domaine : ${metier}`,
    `Projet r√©alis√© en classe sur le th√®me : ${metier}`
  ].forEach(s => {
    const li = document.createElement("li");
    li.contentEditable = true;
    li.className = "editable";
    li.textContent = s;
    stageList.appendChild(li);
  });

  const bg = document.querySelector(".cv-left");

const metiersCIEL = [
  "Technicien R√©seaux", "Technicien Informatique", "Technicien Support", 
  "Technicien √âlectronique", "D√©veloppeur Web", "Installateur Domotique", 
  "Int√©grateur IoT", "Technicien Cybers√©curit√©"
];

const metiersMELEC = [
  "√âlectricien du B√¢timent", "Technicien de Maintenance", 
  "√âlectricien Industriel", "Technicien en R√©gulation CVC"
];

const metiersChaudronnerie = [
  "Ouvrier Chaudronnier", "Soudeur", "Assembleur M√©tallique", 
  "Monteur en Tuyauterie", "Op√©rateur CN", "Contr√¥leur Qualit√©"
];

if (metiersCIEL.includes(metier)) {
  bg.style.background = "#3399ff"; // Bleu CIEL
} else if (metiersMELEC.includes(metier)) {
  bg.style.background = "#117a3a"; // Vert MELEC
} else if (metiersChaudronnerie.includes(metier)) {
  bg.style.background = "#555555"; // Gris m√©tal
} else {
  bg.style.background = "#444"; // Par d√©faut
}

}

function addCompetence() {
  const li = document.createElement("li");
  li.innerHTML = `
    <div contenteditable="true" class="editable">Nouvelle comp√©tence</div>
    <div class="skill-bar"><div class="fill" style="width: 50%;"></div></div>
  `;
  document.getElementById("competences").appendChild(li);
}


function addStage() {
  const li = document.createElement("li");
  li.contentEditable = true;
  li.className = "editable";
  li.textContent = "Nouvelle exp√©rience";
  document.getElementById("stages").appendChild(li);
}

function addLoisir() {
  const li = document.createElement("li");
  li.contentEditable = true;
  li.className = "editable";
  li.textContent = "Nouveau loisir";
  document.getElementById("loisirs").appendChild(li);
}

function generatePDF() {
  const cvContainer = document.getElementById("cvContent");
  cvContainer.classList.add("force-desktop");

  document.getElementById("btnAddComp").style.display = "none";
  document.getElementById("btnAddStage").style.display = "none";
  document.getElementById("btnAddLoisir").style.display = "none";

  const element = document.getElementById("cvContent");
  const opt = {
    margin: 0,
    filename: 'CV_Personnalise.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 1.5, useCORS: true },
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
    pagebreak: { mode: ['avoid-all'] }
  };

  html2pdf().set(opt).from(element).save().then(() => {
    cvContainer.classList.remove("force-desktop");
    document.getElementById("btnAddComp").style.display = "inline-block";
    document.getElementById("btnAddStage").style.display = "inline-block";
    document.getElementById("btnAddLoisir").style.display = "inline-block";
  });
}
function uploadPhoto() {
  document.getElementById("uploadInput").click();
}

document.getElementById("uploadInput").addEventListener("change", function(e) {
  const reader = new FileReader();
  reader.onload = function(event) {
    document.getElementById("photoCV").src = event.target.result;
  };
  reader.readAsDataURL(e.target.files[0]);
});


window.onload = updateCV;
</script>

</body>
</html>
